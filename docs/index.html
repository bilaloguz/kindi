<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kindi</title>
    <link rel="icon" href="data:,">
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#1a1a1a; color:#e0e0e0; padding:20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { text-align:center; color:#4fc3f7; margin-bottom:10px; }
        .subtitle { text-align:center; color:#888; margin-bottom:30px; }
        .stats-grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap:15px; margin-bottom:30px; }
        .stat-card { background:#2a2a2a; padding:20px; border-radius:10px; border-left:4px solid #4fc3f7; }
        .stat-card h3 { font-size:0.9em; color:#888; margin-bottom:5px; }
        .stat-card .value { font-size:2em; color:#4fc3f7; font-weight:bold; }
        .stat-card .subvalue { font-size:0.85em; color:#aaa; margin-top:5px; }
        .tables-grid { display:grid; grid-template-columns: repeat(2, 1fr); gap:20px; margin-bottom:30px; }
        .table-card { background:#2a2a2a; padding:20px; border-radius:10px; }
        .table-card h2 { color:#4fc3f7; margin-bottom:15px; font-size:1.3em; }
        table { width:100%; border-collapse:collapse; }
        th { background:#333; color:#4fc3f7; padding:10px; text-align:left; font-size:0.9em; }
        td { padding:8px 10px; border-bottom:1px solid #333; }
        tr:hover { background:#333; }
        .frequency { color:#81c784; font-weight:bold; }
        .last-word { color:#aaa; font-size:0.9em; }
        .words-section { background:#2a2a2a; padding:20px; border-radius:10px; margin-bottom:20px; }
        .word-cloud { display:flex; flex-wrap:wrap; gap:10px; }
        .word-tag { background:#333; color:#e0e0e0; padding:5px 12px; border-radius:15px; font-size:0.9em; }
        .loading { text-align:center; color:#888; padding:40px; }
        .refresh-info { text-align:center; color:#666; font-size:0.85em; margin-top:20px; }
        .last-updated { text-align:center; color:#4fc3f7; font-size:0.9em; margin-bottom:20px; font-weight:bold; }
        .error { background:#d32f2f; color:white; padding:15px; border-radius:5px; margin:20px 0; }
    </style>
    <script>
        function formatPercent(part, total) {
            if (!total || !part) return '%0';
            const pct = (part / total) * 100;
            return '%' + pct.toLocaleString('tr-TR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }
        async function loadData() {
            try {
                const res = await fetch('data.json?ts=' + Date.now(), { cache: 'no-store' });
                const data = await res.json();
                render(data);
            } catch (e) {
                document.getElementById('content').innerHTML = `<div class="error">Veriler yüklenemedi: ${e.message}</div>`;
            }
        }
        function formatDateTime(isoString) {
            if (!isoString) return '';
            const date = new Date(isoString);
            return date.toLocaleString('tr-TR', { 
                timeZone: 'Europe/Istanbul',
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit', 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit'
            });
        }
        function render(data) {
            const lastUpdated = data.last_updated ? `<div class="last-updated">Son Güncelleme: ${formatDateTime(data.last_updated)}</div>` : '';
            const html = `
                ${lastUpdated}
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Taranan Sayfa</h3>
                        <div class="value">${data.stats.pages.toLocaleString()}</div>
                        <div class="subvalue">${data.stats.queue.toLocaleString()} kuyrukta</div>
                    </div>
                    <div class="stat-card">
                        <h3>Türkçe Kelime</h3>
                        <div class="value">${data.stats.words.toLocaleString()}</div>
                        <div class="subvalue">Benzersiz kelime</div>
                    </div>
                    <div class="stat-card">
                        <h3>Heceler</h3>
                        <div class="value">${data.stats.syllables.unique.toLocaleString()}</div>
                        <div class="subvalue">${data.stats.syllables.total.toLocaleString()} toplam</div>
                    </div>
                    <div class="stat-card">
                        <h3>Harfler</h3>
                        <div class="value">${data.stats.monographs.unique}</div>
                        <div class="subvalue">${data.stats.monographs.total.toLocaleString()} toplam</div>
                    </div>
                    <div class="stat-card">
                        <h3>İkili Harfler</h3>
                        <div class="value">${data.stats.digraphs.unique}</div>
                        <div class="subvalue">${data.stats.digraphs.total.toLocaleString()} toplam</div>
                    </div>
                    <div class="stat-card">
                        <h3>Üçlü Harfler</h3>
                        <div class="value">${data.stats.trigraphs.unique.toLocaleString()}</div>
                        <div class="subvalue">${data.stats.trigraphs.total.toLocaleString()} toplam</div>
                    </div>
                </div>

                <div class="tables-grid">
                    <div class="table-card">
                        <h2>En Çok 20 Hece</h2>
                        <table>
                            <thead><tr><th>#</th><th>Hece</th><th>Sıklık</th><th>Son Kelime</th></tr></thead>
                            <tbody>
                                ${data.top_syllables.map((item,i)=>`
                                    <tr>
                                        <td>${i+1}</td>
                                        <td><strong>${item.syllable}</strong></td>
                                        <td class="frequency">${formatPercent(item.frequency, data.stats.syllables.total)}</td>
                                        <td class="last-word">${item.last_word}</td>
                                    </tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="table-card">
                        <h2>En Çok 20 Harf</h2>
                        <table>
                            <thead><tr><th>#</th><th>Harf</th><th>Sıklık</th><th>Son Kelime</th></tr></thead>
                            <tbody>
                                ${data.top_monographs.map((item,i)=>`
                                    <tr>
                                        <td>${i+1}</td>
                                        <td><strong>${item.monograph}</strong></td>
                                        <td class="frequency">${formatPercent(item.frequency, data.stats.monographs.total)}</td>
                                        <td class="last-word">${item.last_word}</td>
                                    </tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="table-card">
                        <h2>En Çok 20 İkili Harf</h2>
                        <table>
                            <thead><tr><th>#</th><th>İkili Harf</th><th>Sıklık</th><th>Son Kelime</th></tr></thead>
                            <tbody>
                                ${data.top_digraphs.map((item,i)=>`
                                    <tr>
                                        <td>${i+1}</td>
                                        <td><strong>${item.digraph}</strong></td>
                                        <td class="frequency">${formatPercent(item.frequency, data.stats.digraphs.total)}</td>
                                        <td class="last-word">${item.last_word}</td>
                                    </tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                    <div class="table-card">
                        <h2>En Çok 20 Üçlü Harf</h2>
                        <table>
                            <thead><tr><th>#</th><th>Üçlü Harf</th><th>Sıklık</th><th>Son Kelime</th></tr></thead>
                            <tbody>
                                ${data.top_trigraphs.map((item,i)=>`
                                    <tr>
                                        <td>${i+1}</td>
                                        <td><strong>${item.trigraph}</strong></td>
                                        <td class="frequency">${formatPercent(item.frequency, data.stats.trigraphs.total)}</td>
                                        <td class="last-word">${item.last_word}</td>
                                    </tr>`).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="words-section">
                    <h2>Rastgele Türkçe Kelimeler (${data.stats.words.toLocaleString()} toplam)</h2>
                    <div class="word-cloud">${data.random_words.map(w=>`<span class="word-tag">${w.word}</span>`).join('')}</div>
                </div>
            `;
            document.getElementById('content').innerHTML = html;
        }
        window.addEventListener('load', ()=>{
            document.getElementById('content').innerHTML = '<div class="loading">Veriler yükleniyor...</div>';
            loadData();
            // Re-fetch every 5 seconds (GitHub Pages will show new data after data.json is updated in the repo)
            setInterval(loadData, 5000);
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>Kindi</h1>
        <p class="subtitle">Türkçe Sıklık Analizi</p>
        <div id="content"><div class="loading">Veriler yükleniyor...</div></div>
        <div class="refresh-info">GitHub Pages için statik gösterim</div>
    </div>
</body>
</html>


